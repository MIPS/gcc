Needs upstreaming. Merge with other bonding changes?
