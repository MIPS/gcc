Needs upstreaming and/or reworking
